function filterStrings(c,b){var e=RegExp(b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");return $.grep(c,function(b){return e.test(b)})} $.fn.autoComplete=function(c){var c=$.extend({},{delay:125,filter:filterStrings,formatResult:function(b){return b},maxResultCount:10,minCharacterCount:2,separator:null,sourcePacks:[]},c),b=$("#autoCompleteResults");b.length||(b=$("<ul>",{id:"autoCompleteResults",style:"display:none"}).appendTo("body"));var e=c.separator,g,h;e?(g=function(b){b=b.split(e);return $.trim(b[b.length-1])},h=function(b,d){var c=b.split(e);c[c.length-1]=d;return $.map(c,$.trim).join(e+" ")+e+" "}):(g=function(b){return $.trim(b)}, h=function(b,d){return d});return $(this).each(function(){function e(a){var c=b.children(),k=c.length-1;a<0?a=0:a>k&&(a=k);f!=a&&(d.trigger("itemBlur",[c[f]]),f=a);d.trigger("itemFocus",[c[a]])}var d=$(this),i,f;d.keyup(function(a){a=a.keyCode;if(a==40)b.is(":visible")&&e(f+1);else if(a==38)b.is(":visible")&&e(f-1);else if(a==13)b.is(":visible")&&(a=b.children(),d.trigger("itemSelect",[a[f]]));else{var a=d.val(),j=a.length;i!=j&&(i=j,g(a).length>=c.minCharacterCount?setTimeout(function(){d.trigger("autoPrompt")}, c.delay):d.trigger("inputBlur"))}}).keydown(function(a){a=a.keyCode;if(a==13)return!1;else if(a==27&&b.is(":visible"))return d.trigger("inputBlur"),!1}).bind({autoPrompt:function(){var a=d.val(),a=c.filter(c.sourcePacks,g(a)).splice(0,c.maxResultCount);a.length?(b.html($.map(a,function(a){return"<li>"+c.formatResult(a)+"</li>"}).join("")).css({position:"absolute",top:function(){return d.offset().top+d.height()},left:function(){return d.offset().left}}).undelegate(".autoComplete").delegate("li",{"mouseenter.autoComplete":function(){e($(this).prevAll().length)}, "mouseleave.autoComplete":function(){d.trigger("itemBlur",[this])},"click.autoComplete":function(){d.trigger("itemSelect",[this])}}).show(),e(0)):b.hide()},itemFocus:function(a,b){$(b).addClass("autoCompleteSelection")},itemBlur:function(a,b){$(b).removeClass("autoCompleteSelection")},itemSelect:function(a,b){var c=h(d.val(),$(b).text());d.val(c).trigger("inputBlur").focus();i=c.length},inputBlur:function(){b.hide()}});$(document).bind("click focusin",function(a){if(b.is(":visible"))a=a.target,a== b[0]||a==d[0]||d.trigger("inputBlur")})})};
