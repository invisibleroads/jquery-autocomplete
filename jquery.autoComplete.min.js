function filterStrings(e,b){var f=RegExp(b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");return $.grep(e,function(b){return f.test(b)})}
$.fn.autoComplete=function(e){var e=$.extend({},{delay:125,filter:filterStrings,formatResult:function(d){return d},maxResultCount:10,minCharacterCount:2,separator:null,sourcePacks:[]},e),b=$("#autoCompleteResults");b.length||(b=$("<ul>",{id:"autoCompleteResults",style:"display:none"}).appendTo("body"));var f=e.separator,i,j;f?(i=function(d){d=d.split(f);return $.trim(d[d.length-1])},j=function(d,c){var b=d.split(f);b[b.length-1]=c;return $.map(b,$.trim).join(f+" ")+f+" "}):(i=function(b){return $.trim(b)},
j=function(b,c){return c});return $(this).each(function(){function d(a){var g=b.children(),d=g.length-1;a<0?a=0:a>d&&(a=d);h!=a&&(c.trigger("itemBlur",[g[h]]),h=a);c.trigger("itemFocus",[g[a]])}var c=$(this),f,h;c.keyup(function(a){a=a.keyCode;if(a==40)b.is(":visible")&&d(h+1);else if(a==38)b.is(":visible")&&d(h-1);else if(a==13)b.is(":visible")&&(a=b.children(),c.trigger("itemSelect",[a[h]]));else{var a=c.val(),g=a.length;f!=g&&(f=g,i(a).length>=e.minCharacterCount?setTimeout(function(){c.trigger("autoPrompt")},
e.delay):c.trigger("inputBlur"))}}).keydown(function(a){a=a.keyCode;if(a==13)return!1;else if(a==27&&b.is(":visible"))return c.trigger("inputBlur"),!1}).bind({autoPrompt:function(){var a=c.val(),a=e.filter(e.sourcePacks,i(a)).splice(0,e.maxResultCount);a.length?(b.html($.map(a,function(a){return"<li>"+e.formatResult(a)+"</li>"}).join("")).css({position:"absolute",top:function(){return c.offset().top+c.height()},left:function(){return c.offset().left}}).undelegate(".autoComplete").delegate("li",{"mouseenter.autoComplete":function(){d($(this).prevAll().length)},
"mouseleave.autoComplete":function(){c.trigger("itemBlur",[this])},"mousedown.autoComplete":function(){c.trigger("itemSelect",[this])}}).show(),d(0)):b.hide()},itemFocus:function(a,b){$(b).addClass("autoCompleteSelection")},itemBlur:function(a,b){$(b).removeClass("autoCompleteSelection")},itemSelect:function(a,b){var d=j(c.val(),$(b).text());c.val(d).trigger("inputBlur");setTimeout(function(){c.focus()},0);f=d.length},inputBlur:function(){b.hide()}});$(document).bind("mouseup focusin",function(){c.trigger("inputBlur")})})};
